<html layout:decorate="~{layout}">
<div layout:fragment="content">
    <div class="authority my-4">
        <h3 class="border-bottom pb-2">회원정보 수정</h3>
        <form th:action="@{|/user/snsUserModify/${user.loginId}|}" th:object="${snsUserModifyForm}" method="post"
              id="modifyForm">
            <div th:replace="~{form_errors :: formErrorsFragment}"></div>
            <div class="d-flex align-items-center mb-3 border-bottom pb-1">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                     class="bi bi-person-vcard me-1" viewBox="0 0 16 16">
                    <path d="M5 8a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm4-2.5a.5.5 0 0 1 .5-.5h4a.5.5 0 0 1 0 1h-4a.5.5 0 0 1-.5-.5ZM9 8a.5.5 0 0 1 .5-.5h4a.5.5 0 0 1 0 1h-4A.5.5 0 0 1 9 8Zm1 2.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 0 1h-3a.5.5 0 0 1-.5-.5Z"/>
                    <path d="M2 2a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H2ZM1 4a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v8a1 1 0 0 1-1 1H8.96c.026-.163.04-.33.04-.5C9 10.567 7.21 9 5 9c-2.086 0-3.8 1.398-3.984 3.181A1.006 1.006 0 0 1 1 12V4Z"/>
                </svg>
                <div>권한 설정</div>
            </div>
            <select th:field="*{authority}" class="form-select mb-3">
                <option value="" selected>권한을 선택하세요.</option>
                <option value="손님">손님</option>
                <option value="사장님">사장님</option>
            </select>
            <div class="d-flex align-items-center mb-3 border-bottom pb-1">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                     class="bi bi-image me-1"
                     viewBox="0 0 16 16">
                    <path d="M6.002 5.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z"/>
                    <path d="M2.002 1a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2h-12zm12 1a1 1 0 0 1 1 1v6.5l-3.777-1.947a.5.5 0 0 0-.577.093l-3.71 3.71-2.66-1.772a.5.5 0 0 0-.63.062L1.002 12V3a1 1 0 0 1 1-1h12z"/>
                </svg>
                <div>이미지 선택</div>
            </div>
            <div style="width:80%; margin:0 auto;">
                <input type="hidden" id="image" name="image">
                <div style="width:90%; margin:0 auto;">
                    <div class="d-flex justify-content-around mb-3">
                        <img src="/image/user/wUser1.jpg" class="img" style="border-radius:50%; width:20%;"
                             onclick="selectImage(this)">
                        <img src="/image/user/wUser2.jpg" class="img" style="border-radius:50%; width:20%;"
                             onclick="selectImage(this)">
                        <img src="/image/user/wUser3.jpg" class="img" style="border-radius:50%; width:20%;"
                             onclick="selectImage(this)">
                    </div>
                    <div class="col d-flex justify-content-around">
                        <img src="/image/user/mUser1.jpg" class="img" style="border-radius:50%; width:20%;"
                             onclick="selectImage(this)">
                        <img src="/image/user/mUser2.jpg" class="img" style="border-radius:50%; width:20%;"
                             onclick="selectImage(this)">
                        <img src="/image/user/mUser3.jpg" class="img" style="border-radius:50%; width:20%;"
                             onclick="selectImage(this)">
                    </div>
                </div>
            </div>
            <div class="d-flex justify-content-end">
                <input type="button" value="수정" class="버튼 btn" id="modifyBtn">
            </div>
        </form>
    </div>
    <script type="text/javascript">
        const modify = document.querySelector("#modifyBtn");
        modify.addEventListener('click', function() {
            if (document.querySelector("#image").value == '')
                alert("프로필 이미지를 선택해주세요.");
            else
                document.querySelector("#modifyForm").submit();
        });

        function selectImage(image) {
          var allImages = document.querySelectorAll('.img');
          allImages.forEach(function (img) {
            img.classList.remove('selectedImage');
          });
          image.classList.add('selectedImage');
          var currentOrigin = window.location.origin;
          var imagePath = image.src.replace(currentOrigin, '');
          document.querySelector("#image").value = imagePath;
        }
    </script>
</div>
</html>

