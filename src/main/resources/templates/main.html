<html layout:decorate="~{layout}">
<div layout:fragment="content">
    <div class="d-flex justify-content-between">
        <div id="map" style="width:70%; height:80vh; border-radius:15px; position:relative; z-index:0;">
            <div style="position:absolute; z-index:99; top:3%; left:3%;">
                <button class="버튼 btn btn-sm me-2" onclick="aroundMe()">내 위치 주변</button>
                <button class="버튼 btn btn-sm" onclick="searchForAddress()">주소 검색</button>
            </div>
        </div>
        <div style="width:25%; border:2px solid tan; background:white; padding:20px; border-radius:15px;">
            <div class="d-flex align-items-center mb-3" sec:authorize="isAuthenticated()">
                <svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" fill="currentColor"
                     class="bi bi-person-fill me-1" viewBox="0 0 16 16">
                    <path d="M3 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1H3Zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"/>
                </svg>
                <div>
                    <div style="font-size:10pt; color:gray;" th:text="${user.authority}"></div>
                    <div class="d-flex align-items-end border-bottom">
                        <div th:text="${user.name}" style="font-size:15pt;"></div>
                        <div>님 환영합니다.</div>
                    </div>
                </div>
            </div>
            <div class="card" sec:authorize="isAuthenticated()">
                <ul class="list-group list-group-flush">
                    <li class="d-flex align-items-center list-group-item">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                             class="bi bi-file-person me-1" viewBox="0 0 16 16">
                            <path d="M12 1a1 1 0 0 1 1 1v10.755S12 11 8 11s-5 1.755-5 1.755V2a1 1 0 0 1 1-1h8zM4 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H4z"/>
                            <path d="M8 10a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/>
                        </svg>
                        <a th:href="@{|/user/userDetail/${user.loginId}|}">마이페이지 ></a>
                    </li>
                    <li class="d-flex align-items-center list-group-item" th:if="${user.authority == '사장님'}">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                             class="bi bi-shop me-1" viewBox="0 0 16 16">
                            <path d="M2.97 1.35A1 1 0 0 1 3.73 1h8.54a1 1 0 0 1 .76.35l2.609 3.044A1.5 1.5 0 0 1 16 5.37v.255a2.375 2.375 0 0 1-4.25 1.458A2.371 2.371 0 0 1 9.875 8 2.37 2.37 0 0 1 8 7.083 2.37 2.37 0 0 1 6.125 8a2.37 2.37 0 0 1-1.875-.917A2.375 2.375 0 0 1 0 5.625V5.37a1.5 1.5 0 0 1 .361-.976l2.61-3.045zm1.78 4.275a1.375 1.375 0 0 0 2.75 0 .5.5 0 0 1 1 0 1.375 1.375 0 0 0 2.75 0 .5.5 0 0 1 1 0 1.375 1.375 0 1 0 2.75 0V5.37a.5.5 0 0 0-.12-.325L12.27 2H3.73L1.12 5.045A.5.5 0 0 0 1 5.37v.255a1.375 1.375 0 0 0 2.75 0 .5.5 0 0 1 1 0zM1.5 8.5A.5.5 0 0 1 2 9v6h1v-5a1 1 0 0 1 1-1h3a1 1 0 0 1 1 1v5h6V9a.5.5 0 0 1 1 0v6h.5a.5.5 0 0 1 0 1H.5a.5.5 0 0 1 0-1H1V9a.5.5 0 0 1 .5-.5zM4 15h3v-5H4v5zm5-5a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-2a1 1 0 0 1-1-1v-3zm3 0h-2v3h2v-3z"/>
                        </svg>
                        <a th:href="@{|/restaurant/page/${user.loginId}|}">가게 관리 ></a>
                    </li>
                    <li class="list-group-item d-flex align-items-center" th:if="${user.authority == '사장님'}">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                             class="bi bi-calendar-check me-1" viewBox="0 0 16 16">
                            <path d="M10.854 7.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7.5 9.793l2.646-2.647a.5.5 0 0 1 .708 0z"/>
                            <path d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5zM1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4H1z"/>
                        </svg>
                        <a th:href="@{/reserve/manage}">예약 관리 ></a>
                    </li>
                    <li class="list-group-item" th:if="${user.authority == '사장님'}">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                             class="bi bi-plus-square me-1" viewBox="0 0 16 16">
                            <path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/>
                            <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"/>
                        </svg>
                        <a th:href="@{/restaurant/register}">가게 등록 ></a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    <form th:action="@{/interprocess}" method="get" id="address">
        <input type="hidden" id="inputAddress" name="inputAddress" th:value="${inputAddress}">
    </form>
    <input type="hidden" id="searchAddress" th:value="${inputAddress}">
    <script>
        var token = $("meta[name='_csrf']").attr("content");
        var header = $("meta[name='_csrf_header']").attr("content");
        $(function() {
            $(document).ajaxSend(function(e, xhr, options) {
                xhr.setRequestHeader(header, token);
            });
        });
    </script>
    <script type="text/javascript"
            src="//dapi.kakao.com/v2/maps/sdk.js?appkey=ea7706d3cd280b86aceebdabe80d16f0&libraries=services"></script>
    <script type="text/javascript" th:inline="javascript">
        var resArr = new Array();
        [# th:each="res : ${resList}"]
            var resObj = new Object();
            resObj.id = [[${res.id}]];
            resObj.name = [[${res.name}]];
            resObj.address = [[${res.address}]];
            resObj.x = [[${res.locationX}]];
            resObj.y = [[${res.locationY}]];
            resObj.image = [[${res.image}]];
            resObj.averageStar = [[${res.averageStar}]];
            resArr.push(resObj);
        [/]
        var myX = [[${x}]];
        var myY = [[${y}]];
    </script>
    <script type="text/javascript" th:src="@{/map.js}"></script>
    <script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
    <script>
        function searchForAddress() {
            new daum.Postcode({
                oncomplete: function(data) {
                    document.querySelector('#inputAddress').value = data.address;
                    document.querySelector('#address').submit();
                }
            }).open();
        }

        function aroundMe() {
            document.querySelector('#inputAddress').value = 'aroundMe';
            document.querySelector('#address').submit();
        }
    </script>
</div>
</html>